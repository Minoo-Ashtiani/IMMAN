library(igraph)
library(Biostrings)
library(seqinr)
library(STRINGdb)

data(H.sapiens)
data(R.norvegicus)
data(Celegance)
data(FruitFly)

ProteinLists = list(as.character(H.sapiens$V1), as.character(R.norvegicus$V1),
 as.character(Celegance$V1), as.character(FruitFly$V1))

List1_Species_ID = 9606  # taxonomy ID List1 Homo sapiens
List2_Species_ID = 10116 # taxonomy ID List2 Rat
List3_Species_ID = 6239  # taxonomy ID List3 Celegance
List4_Species_ID = 7227  # taxonomy ID List4 FruitFly

Species_IDs  = c(List1_Species_ID, List2_Species_ID, List3_Species_ID, List4_Species_ID)

# Set the parameters to run the analysis.
# Here is a description of parameters in IMMAN. If you need more
# information you can refer to the paper.
# identityU: Cut off value for selecting proteins whose alignment score
# is greater or equal than identityU
# substitutionMatrix: Which scoring matrix to be used for alignment
# setting gapOpening and gapExtension for alignment purposes
# For NetworkShrinkage, coverage, and BestHit refer to paper
# score_threshold:
# STRINGversion: Indicated which version of STRING database should
# program search in for the score of PPIs.

identityU = 30
substitutionMatrix = "BLOSUM62"
gapOpening = -8
gapExtension = -8
NetworkShrinkage = FALSE
coverage = 1
BestHit = TRUE
score_threshold = 400
STRINGversion="10"

# Run the IMMAN function for the parameters

output = IMMAN(ProteinLists, fileNames=NULL, Species_IDs,
              identityU, substitutionMatrix,
              gapOpening, gapExtension, BestHit,
              coverage, NetworkShrinkage,
              score_threshold, STRINGversion,
              InputDirectory = getwd())

output$IPNEdges
output$IPNNodes
output$Networks
output$Networks[[1]]
output$maps
output$maps[[2]]

# IMMAN(ProteinLists=list(as.character(H.sapiens$V1), as.character(R.norvegicus$V1)), fileNames=NULL, Species_IDs,
#       identityU = 30,
#       substitutionMatrix = "BLOSUM62",
#       gapOpening = -8,
#       gapExtension = -8,
#       NetworkShrinkage = FALSE,
#       coverage = 1,
#       BestHit = TRUE,
#       score_threshold = 400,
#       STRINGversion="10",
#       InputDirectory = getwd())
